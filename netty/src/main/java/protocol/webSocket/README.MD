# WebSocket

Ajax使得网络动态，但是HTTP通信依旧是Client控制的，这就需要用户定期轮询or进行互动，以便从服务器加载新数据。

**长轮询**，利用长轮询客户端可以打开指向服务器的HTTP连接，而服务器会一直打开，直到发送响应。服务器只要有新数据，就会发送响应（其他技术包括flash，XHR multipart请求和所谓的HTML Files）。长轮询和其他技术非常好用，在IM中都会经常使用。

这些解决方案都存在共同问题，由于HTTP协议的开销，导致他们不适用于低延迟应用。

为了解决这些问题，WebSocket将网络套接字引入到了Client和Server，浏览器和服务器之间可以通过Socket建立持久的连接，双方随时都可以互发数据给对方，而不是像之前由客户端一请求一应答模式。

# HTTP协议的弊端

- HTTP协议为半双工协议

半双工(Half Duplex)数据传输指数据可以在一个信号载体的两个方向上传输，但是不能同时传输。意味着在同一时刻，只有一个方向上的数据传输

- HTTP消息冗长而繁琐

HTTP消息包含消息头，消息体，换行符等。通常采用文本方式传输，相对于其他二进制通信协议，冗长而繁琐

- 针对服务器推送的黑客攻击

eg：长时间轮询


现在，大多网站为了实现消息推送，所用的技术都是轮询(在特定的时间间隔，一秒)。由浏览器对服务器发出的HTTP request，然后由服务器返回最新的数据给客户端浏览器。
缺点：browser需要不断的向Server发出请求，然而HTTP request的header十分的冗长，里面包含的可用数据比例低，占用很多的带宽和服务器资源。

最新的轮询技术是Comet，使用了Ajax，虽然可以实现双向通信，但依然需要发出请求，然而在Comet中，普遍采用了长连接，这大量消耗服务器带宽和资源。

H5定义了WebSocket协议。



